{"ast":null,"code":"import _classCallCheck from\"/Users/alext/Documents/DjangoREST/\\u041D\\u0438\\u043A\\u043E\\u043B\\u0430\\u0438\\u0306 \\u041D\\u0430\\u0433\\u043E\\u0440\\u043D\\u044B\\u0438\\u0306/To_do/DRF/production/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/alext/Documents/DjangoREST/\\u041D\\u0438\\u043A\\u043E\\u043B\\u0430\\u0438\\u0306 \\u041D\\u0430\\u0433\\u043E\\u0440\\u043D\\u044B\\u0438\\u0306/To_do/DRF/production/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/alext/Documents/DjangoREST/\\u041D\\u0438\\u043A\\u043E\\u043B\\u0430\\u0438\\u0306 \\u041D\\u0430\\u0433\\u043E\\u0440\\u043D\\u044B\\u0438\\u0306/To_do/DRF/production/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/alext/Documents/DjangoREST/\\u041D\\u0438\\u043A\\u043E\\u043B\\u0430\\u0438\\u0306 \\u041D\\u0430\\u0433\\u043E\\u0440\\u043D\\u044B\\u0438\\u0306/To_do/DRF/production/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";// import logo from './logo.svg';\nimport'./App.css';import React from\"react\";import axios from\"axios\";import{Route,BrowserRouter,Switch}from\"react-router-dom\";import Menu from\"./components/Menu.js\";import UserList from\"./components/User.js\";import ProjectList from\"./components/Project.js\";import NoteList from\"./components/Note.js\";import Footer from\"./components/Footer.js\";import Error404 from\"./components/Error404.js\";import NotesOfProject from\"./components/NotesOfProject.js\";import UserLoginForm from\"./components/AppForLoginUser.js\";import Cookies from\"universal-cookie/es6\";import ProjectForm from\"./components/ProjectForm\";import NoteForm from\"./components/NoteForm\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=/*#__PURE__*/function(_React$Component){_inherits(App,_React$Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this.state={'users':[],'projects':[],'notes':[],'status_of_auth':{'user':'','is_in':false,'token':'','user_id':''}};return _this;}_createClass(App,[{key:\"get_headers\",value:function get_headers(){var headers={'Content-Type':'application/json'};headers['Authorization']=\"Token \".concat(this.state.status_of_auth.token);return headers;}},{key:\"get_id\",value:function get_id(arr,elem){for(var i=0;i<arr.length;i++){if(arr[i]['username']===elem){return this.state.users[i].id;}}return false;}},{key:\"load_all_data_on_start\",value:function load_all_data_on_start(){var _this2=this;console.log('load all data start');var headers=this.get_headers();console.log('getting headers '+headers['Authorization']);axios.get('http://127.0.0.1:8000/api/users/',{headers:headers}).then(function(response){_this2.setState({'users':response.data});}).catch(function(error){console.log(error);});axios.get('http://127.0.0.1:8000/api/projects/',{headers:headers}).then(function(response){_this2.setState({'projects':response.data});}).catch(function(error){console.log(error);});axios.get('http://127.0.0.1:8000/api/notes/',{headers:headers}).then(function(response){_this2.setState({'notes':response.data});}).catch(function(error){console.log(error);});}},{key:\"let_logout\",value:function let_logout(){var _this3=this;console.log('Clearing data');this.setState({'notes':[]});this.setState({'user':[]});this.setState({'projects':[]});this.setState({'status_of_auth':{'user':'','token':'','is_in':false,'user_id':''}},function(){return _this3.load_all_data_on_start();});}},{key:\"set_token_to_cook_state\",value:function set_token_to_cook_state(token,user_login){var _this4=this;var cookie=new Cookies();cookie.set('token',token);this.setState({'status_of_auth':{'user':user_login,'is_in':true,'token':token,'user_id':''}},function(){return _this4.load_all_data_on_start();});}},{key:\"get_token_from_cookie\",value:function get_token_from_cookie(){var _this5=this;var cookie_from=new Cookies();var token=cookie_from.get('token');this.setState({'status_of_auth':{'token':token}},function(){return _this5.load_all_data_on_start();});}},{key:\"get_token_from_backend\",value:function get_token_from_backend(user_login,user_pass){var _this6=this;axios.post('http://localhost:8000/api-token-auth/',{username:user_login,password:user_pass}).then(function(response){_this6.set_token_to_cook_state(response.data['token'],user_login);}).catch(function(error){console.log(error);});}},{key:\"create_note\",value:function create_note(project_id,text_of_note){var _this7=this;var headers=this.get_headers();var data={name_of_project:project_id,author_of_todo:this.get_id(this.state.users,this.state.status_of_auth.user),text_of_todo:text_of_note};axios.post('http://127.0.0.1:8000/api/notes',data,{headers:headers}).then(function(response){_this7.load_all_data_on_start();}).catch(function(error){console.log(error);});}},{key:\"delete_note\",value:function delete_note(id){var _this8=this;var headers=this.get_headers();axios.delete(\"http://localhost:8000/api/notes/\".concat(id,\"/\"),{headers:headers}).then(function(response){_this8.load_all_data_on_start();}).catch(function(error){console.log(error);});}},{key:\"create_project\",value:function create_project(name_of_project,authors){var _this9=this;var headers=this.get_headers();var data={name_of_project:name_of_project,list_of_users:[7,8]};axios.post(\"http://127.0.0.1:8000/api/projects/\",data,{headers:headers}).then(function(response){_this9.load_all_data_on_start();}).catch(function(error){console.log(error);});}},{key:\"delete_project\",value:function delete_project(id){var _this10=this;var headers=this.get_headers();axios.delete(\"http://localhost:8000/api/projects/\".concat(id,\"/\"),{headers:headers}).then(function(response){_this10.load_all_data_on_start();}).catch(function(error){console.log(error);});}},{key:\"componentDidMount\",value:function componentDidMount(){if(this.state.status_of_auth.is_in){this.get_token_from_cookie();}}},{key:\"render\",value:function render(){var _this11=this;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(BrowserRouter,{children:[/*#__PURE__*/_jsx(Menu,{status:this.state.status_of_auth,logout:function logout(){return _this11.let_logout();}}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",component:function component(){return/*#__PURE__*/_jsx(UserList,{users:_this11.state.users});}}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/projects/\",component:function component(){return/*#__PURE__*/_jsx(ProjectList,{projects:_this11.state.projects,delete_project:function delete_project(id){return _this11.delete_project(id);}});}}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/projects/create\",component:function component(){return/*#__PURE__*/_jsx(ProjectForm,{authors:_this11.state.users,create_project:function create_project(name_of_project,authors){return _this11.create_project(name_of_project,authors);}});}}),/*#__PURE__*/_jsxs(Route,{path:\"/project/:id\",children:[\" \",/*#__PURE__*/_jsx(NotesOfProject,{notes:this.state.notes}),\" \"]}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/notes/\",component:function component(){return/*#__PURE__*/_jsx(NoteList,{notes:_this11.state.notes,delete_note:function delete_note(id){return _this11.delete_note(id);}});}}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/note/create\",component:function component(){return/*#__PURE__*/_jsx(NoteForm,{create_note:function create_note(project_id,text_of_note){return _this11.create_note(project_id,text_of_note);}});}}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/login/\",component:function component(){return/*#__PURE__*/_jsx(UserLoginForm,{getToken:function getToken(user_login,user_pass){return _this11.get_token_from_backend(user_login,user_pass);}});}}),/*#__PURE__*/_jsx(Route,{component:Error404})]})]}),/*#__PURE__*/_jsx(Footer,{})]});}}]);return App;}(React.Component);export default App;","map":{"version":3,"sources":["/Users/alext/Documents/DjangoREST/Николай Нагорный/To_do/DRF/production/frontend/src/App.js"],"names":["React","axios","Route","BrowserRouter","Switch","Menu","UserList","ProjectList","NoteList","Footer","Error404","NotesOfProject","UserLoginForm","Cookies","ProjectForm","NoteForm","App","props","state","headers","status_of_auth","token","arr","elem","i","length","users","id","console","log","get_headers","get","then","response","setState","data","catch","error","load_all_data_on_start","user_login","cookie","set","cookie_from","user_pass","post","username","password","set_token_to_cook_state","project_id","text_of_note","name_of_project","author_of_todo","get_id","user","text_of_todo","delete","authors","list_of_users","is_in","get_token_from_cookie","let_logout","projects","delete_project","create_project","notes","delete_note","create_note","get_token_from_backend","Component"],"mappings":"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","sourcesContent":["// import logo from './logo.svg';\nimport './App.css';\nimport React from \"react\";\nimport axios from \"axios\";\nimport {Route, BrowserRouter, Switch} from \"react-router-dom\";\n\n\nimport Menu from \"./components/Menu.js\";\nimport UserList from \"./components/User.js\";\nimport ProjectList from \"./components/Project.js\";\nimport NoteList from \"./components/Note.js\";\nimport Footer from \"./components/Footer.js\";\nimport Error404 from \"./components/Error404.js\";\nimport NotesOfProject from \"./components/NotesOfProject.js\";\nimport UserLoginForm from \"./components/AppForLoginUser.js\";\nimport Cookies from \"universal-cookie/es6\";\nimport ProjectForm from \"./components/ProjectForm\";\nimport NoteForm from \"./components/NoteForm\";\n\n\nclass App extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            'users': [],\n            'projects': [],\n            'notes': [],\n            'status_of_auth': {'user': '', 'is_in': false, 'token': '', 'user_id': ''}\n        }\n    }\n\n    get_headers() {\n        let headers = {\n            'Content-Type': 'application/json'\n        }\n        headers['Authorization'] = `Token ${this.state.status_of_auth.token}`\n        return headers\n    }\n\n    get_id(arr, elem) {\n        for (let i = 0; i < arr.length; i++) {\n            if (arr[i]['username'] === elem) {\n                return this.state.users[i].id\n            }\n        }\n        return false\n    }\n\n    load_all_data_on_start() {\n        console.log('load all data start')\n        const headers = this.get_headers()\n        console.log('getting headers ' + headers['Authorization'])\n\n        axios.get('http://127.0.0.1:8000/api/users/', {headers}).then(response => {\n            this.setState({'users': response.data})\n        }).catch(error => {\n            console.log(error)\n        })\n        axios.get('http://127.0.0.1:8000/api/projects/', {headers}).then(response => {\n            this.setState({'projects': response.data})\n        }).catch(error => {\n            console.log(error)\n        })\n        axios.get('http://127.0.0.1:8000/api/notes/', {headers}).then(response => {\n            this.setState({'notes': response.data})\n        }).catch(error => {\n            console.log(error)\n        })\n    }\n\n    let_logout() {\n        console.log('Clearing data')\n        this.setState({'notes': []})\n        this.setState({'user': []})\n        this.setState({'projects': []})\n        this.setState({\n            'status_of_auth': {\n                'user': '',\n                'token': '',\n                'is_in': false,\n                'user_id': ''\n            }\n        }, () => this.load_all_data_on_start())\n    }\n\n    set_token_to_cook_state(token, user_login) {\n        const cookie = new Cookies()\n        cookie.set('token', token)\n        this.setState({\n                'status_of_auth':\n                    {'user': user_login, 'is_in': true, 'token': token, 'user_id': ''}\n            },\n            () => this.load_all_data_on_start())\n    }\n\n    get_token_from_cookie() {\n        const cookie_from = new Cookies()\n        const token = cookie_from.get('token')\n        this.setState({'status_of_auth': {'token': token}}, () => this.load_all_data_on_start())\n    }\n\n    get_token_from_backend(user_login, user_pass) {\n        axios.post('http://localhost:8000/api-token-auth/',\n            {username: user_login, password: user_pass}).then(response => {\n            this.set_token_to_cook_state(response.data['token'], user_login)\n        }).catch(error => {\n            console.log(error)\n        })\n    }\n\n    create_note(project_id, text_of_note) {\n        const headers = this.get_headers()\n        const data = {\n                    name_of_project:project_id,\n                    author_of_todo: this.get_id(this.state.users, this.state.status_of_auth.user),\n                    text_of_todo: text_of_note\n        }\n        axios.post('http://127.0.0.1:8000/api/notes', data,{headers}).then(response => {this.load_all_data_on_start()\n        }).catch(error => {\n            console.log(error)\n        })\n    }\n\n    delete_note(id) {\n        const headers = this.get_headers()\n        axios.delete(`http://localhost:8000/api/notes/${id}/`, {headers}).then(response => {\n            this.load_all_data_on_start()\n        }).catch(error => {\n            console.log(error)\n        })\n    }\n\n    create_project(name_of_project, authors) {\n        const headers = this.get_headers()\n        const data = {name_of_project: name_of_project, list_of_users: [7, 8]}\n        axios.post(`http://127.0.0.1:8000/api/projects/`, data, {headers}).then(response => {\n            this.load_all_data_on_start()\n        }).catch(error => {\n            console.log(error)\n        })\n\n    }\n\n    delete_project(id) {\n        const headers = this.get_headers()\n        axios.delete(`http://localhost:8000/api/projects/${id}/`, {headers}).then(response => {\n            this.load_all_data_on_start()\n        }).catch(error => {\n            console.log(error)\n        })\n    }\n\n\n    componentDidMount() {\n        if (this.state.status_of_auth.is_in) {\n            this.get_token_from_cookie()\n        }\n    }\n\n    render() {\n        return (\n            <div>\n\n                <BrowserRouter>\n\n                    < Menu status={this.state.status_of_auth} logout={() => this.let_logout()}/>\n                    <Switch>\n\n                        < Route exact path='/' component={() => <UserList users={this.state.users}/>}/>\n\n                        < Route exact path='/projects/'\n                                component={() => <ProjectList projects={this.state.projects}\n                                                              delete_project={(id) => this.delete_project(id)}/>}/>\n\n                        < Route exact path='/projects/create'\n                                component={() => <ProjectForm authors={this.state.users}\n                                                              create_project={(name_of_project, authors) =>\n                                                                  this.create_project(name_of_project, authors)}/>}/>\n\n                        < Route path='/project/:id'> <NotesOfProject notes={this.state.notes}/> </Route>\n\n                        < Route exact path='/notes/' component={() => <NoteList notes={this.state.notes}\n                                                                                delete_note={(id) =>\n                                                                                    this.delete_note(id)}/>}/>\n\n                        < Route exact path='/note/create'\n                                component={() => <NoteForm create_note={(project_id, text_of_note) =>\n                                                               this.create_note(project_id, text_of_note)}/>}/>\n\n                        < Route exact path='/login/'\n                                component={() => <UserLoginForm\n                                    getToken={(user_login, user_pass) =>\n                                        this.get_token_from_backend(user_login, user_pass)}\n                                />}/>\n\n                        < Route component={Error404}/>\n\n\n                    </Switch>\n\n                </BrowserRouter>\n\n                <Footer/>\n\n            </div>\n        )\n    }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}